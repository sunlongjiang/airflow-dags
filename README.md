# airflow-dags
离线处理及调度脚本
# 基础数仓优化与数据治理项目

## 项目概述
该项目旨在优化和迭代基础游戏数据仓库，包括游戏数据块、轮、局表的日常优化与需求开发。通过采用高效的数据处理架构与技术栈，减少了数据处理的时间，提升了数据的处理稳定性，并大幅度降低了成本。

## 主要职责与核心业绩

### 1. 技术管理
- 从业务入手，深入理解业务产出表的每个字段的定义、来源、口径，合理安排数据拆分和数据计算，确保低成本、稳定可靠的数仓架构设计。
- 设计并实施高效的技术方案，确保数据处理流程的稳定与高效。

### 2. 技术栈
- **大数据处理工具**: Spark, Hive, ClickHouse (CK)
- **AWS 技术栈**: EMR, Amazon Athena, S3 对象存储, 集群创建与升级
- **调度与工作流管理**: Airflow

### 3. 数据治理成果
- 对埋点数据进行清洗与优化，生成各类表（块表、轮表、局表）。
  - **块表**: 54 亿条/天
  - **轮表**: 15 亿条/天
  - **局表**: 2 亿条/天
- 通过多次版本优化，显著提升了数据处理效率和稳定性：
  - 从每天需要 7 小时的处理时间优化到 1 小时 30 分钟。
  - 前置任务块表的执行时间从 3 小时缩短至 16 分钟。
  - 稳定性提升，能够处理失败任务并恢复。
  - 集群成本节约 70%，人力成本节约 80%。




# 商业化 ADX 数据链路项目

## 项目概述
本项目致力于设计、搭建和优化商业化广告 ADX（广告交换平台）数据链路，涵盖从数据源采集、存储、处理到最终的业务数据展现。通过高效的架构与技术方案，为业务提供灵活的报表展示能力，支持各种广告数据需求。

## 主要职责与核心业绩

### 1. 技术管理
- 从数据来源、存储成本、可扩展性和性能等方面切入，负责全链路的技术评审。
- 设计并实施低成本、稳定可靠的数据仓库架构和技术方案，确保系统的可扩展性和性能。

### 2. 技术栈
- **大数据处理工具**: Kafka, Flink, Spark, Hive, Doris
- **AWS 技术栈**: EMR, Amazon Athena, S3 对象存储, 集群创建与升级
- **调度与工作流管理**: Airflow

### 3. 数据治理成果
- 负责广告数据链路的整体设计与搭建：
  - **数据采集**: ADX 服务端埋点数据通过 Kafka 写入，数据包括请求、展示、曝光。
  - **数据处理**: 使用 Flink 消费数据，通过 GZIP 压缩将数据转为 Parquet 格式并存入 S3 的指定目录。
  - **数据存储与加载**: 创建 Hive 外表，通过修复分区方式将数据加载至表中，形成 DWD 层表。
  - **数据聚合**: 根据业务需求，完成维度预聚合，并通过 RID 关联请求、曝光和点击数据，形成宽表，构建 DWS 层。
  - **数据输出**: 将数据同步到 ClickHouse（CK），形成 ADS 层数据，对外提供数据接口，业务方可以通过 Superset 灵活组合展示各类报表。

### 4. 赋能业务
- 完成了 ADX 从 0 到 1 的搭建，深度参与了 ADX 的开发与数据链路搭建工作。
- 全权负责 ADX 整个数据链路的设计与实现，为业务提供高效的数据支持，确保 ADX 系统能够快速响应广告数据需求。

## 技术实施

### 架构与工具
本项目采用 Kafka 作为消息队列处理广告数据流，使用 Flink 进行实时数据处理，Spark 进行大规模批处理计算，Hive 和 Doris 存储大规模数据，ClickHouse 提供快速查询服务。通过 AWS 的 EMR 集群服务和 Athena 支持数据存储与查询。Airflow 用于任务调度和管理，确保整个数据链路的高效运行。

### 数据流转与处理
整个 ADX 数据链路处理流程如下：
1. **数据采集**: 服务端埋点数据通过 Kafka 进行实时数据传输。
2. **数据处理与存储**: 使用 Flink 消费数据，并将压缩后的数据存储到 S3，形成 Parquet 格式数据，使用 Hive 创建外表，加载到 DWD 层表。
3. **维度聚合与宽表构建**: 根据需求进行预聚合，形成宽表，构建 DWS 层数据。
4. **数据输出与展示**: 数据同步至 ClickHouse（ADS 层），通过 Superset 提供报表与数据分析支持。

## 贡献与支持
- 本项目成功搭建了 ADX 数据链路，从而为广告业务提供了强大的数据支持与灵活的报表展示能力，直接推动了业务的决策和优化。
- 通过数据治理和架构优化，项目显著提升了数据处理效率、降低了存储成本，并保证了数据链路的高可用性。

## 未来规划
- 持续优化数据处理流程，提升数据存储与处理的性能和扩展性。
- 增加更多的维度和指标支持，进一步提升报表的灵活性和业务支持能力。
- 探索新的大数据技术与架构，进一步降低成本，提高系统的可用性和可扩展性。

